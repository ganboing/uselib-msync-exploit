This bug is a race between uselib() and msync()  

Steps of triggering the bug:  
  
Install Ubuntu 4.10 on Vmware workstation (Number of processors:2 & Number of cores per processor:2)  
http://old-releases.ubuntu.com/releases/warty/  
  
$ sudo apt-get update  
$ sudo apt-get install kernel-tree-2.6.7  
$ mkdir build  
$ cd build  
$ apt-get source kernel-image-2.6.7-1-686-smp  
$ cd kernel-image-2.6.7-i386-2.6.7  
// change directory to config and remove all files in config except "686-smp", "default"  
$ cd ..  
$ fakeroot debian/rules unpack  
// apply patches in build-686-smp  
$ fakeroot debian/rules binary  
$ cd ..  
$ sudo dpkg -i kernel-image-2.6.7-1-686-smp_2.6.7-1ubuntu2_i386.deb  
// The grub settings will be updated accordingly.  
  
compile and run:  
gcc msync-2sleep.c  
./a.out  

Check the message buffer of the kernel by dmesg. We can see "f_dentry is null" and kernel panics.  
However, I don't think we can do this with one sleep only. 
